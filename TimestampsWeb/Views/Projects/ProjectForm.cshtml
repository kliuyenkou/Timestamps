@model TimestampsWeb.ViewModels.ProjectViewModel

<h2>@ViewBag.Title</h2>
<div>
    @if (Model.IsArchived)
    {
        <span id="labelArchived" class="label label-warning pull-right">Archived</span>
        <button id="restore" class="btn btn-link pull-right">Restore</button>
        <button id="archive" class="btn btn-link pull-right hide">Archive</button>
    }
    else
    {
        <span id="labelArchived" class="label label-warning pull-right hide">Archived</span>
        <button id="restore" class="btn btn-link pull-right hide">Restore</button>
        <button id="archive" class="btn btn-link pull-right">Archive</button>
    }

</div>

@using (Html.BeginForm(Model.Action, "Projects"))
{
    @Html.AntiForgeryToken()
    @Html.HiddenFor(m => m.Id)
    @Html.HiddenFor(m => m.IsArchived)
    <div class="form-group">
        @Html.LabelFor(m => m.Title)
        <div>
            @Html.ValidationMessageFor(m => m.Title, "", new {@class = "text-danger"})
            @Html.TextBoxFor(m => m.Title, new {@class = "form-control"})
        </div>
    </div>
    <div class="form-group">
        @Html.LabelFor(m => m.Description)
        <div>
            @Html.ValidationMessageFor(m => m.Description, "", new {@class = "text-danger"})
            @Html.TextAreaFor(m => m.Description, new {@class = "form-control"})
        </div>
    </div>
    <button type="submit" class="btn btn-primary">Save</button>
}

@section scripts
{
    @Scripts.Render("~/bundles/ui")
    <script>
        $(document).ready(function() {
            $("#archive").click(function(e) {
                bootbox.confirm("Are you sure you want to archive this project?",
                    function(result) {
                        if (!result) {
                            return;
                        }
                        var changeView = function () {
                            $("#IsArchived").value = "true";
                            $("#labelArchived").removeClass("hide");
                            $("#restore").removeClass("hide");
                            $("#archive").addClass("hide");
                        };
                        ProjectController.archiveProject($("input[id]").attr("value"), changeView, function () {
                            bootbox.alert("Failed to archive this project.");
                        });
                    });

            });
            $("#restore").click(function(e) {
                bootbox.confirm("Are you sure you want to restore from archive this project?",
                    function(result) {
                        if (!result) {
                            return;
                        }
                        var changeView = function() {
                            $("#IsArchived").value = "false";
                            $("#labelArchived").addClass("hide");
                            $("#restore").addClass("hide");
                            $("#archive").removeClass("hide");
                        };
                        ProjectController.restoreProject($("input[id]").attr("value"), changeView, function () {
                            bootbox.alert("Failed to restore this project.");
                        });
                    }
                );
            });
        });
    </script>
    @Scripts.Render("~/bundles/jqueryval")
}